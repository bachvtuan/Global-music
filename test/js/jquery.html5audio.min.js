(function(g){g.fn.html5audio=function(h){function ge(){var a=0==e.find("div[class='fontMeasure']").length?g("<div/>").addClass("fontMeasure").appendTo(e):e.find("div[class='fontMeasure']");ga=new apTextScroller;ga.init(a,Va,he,"left",h.scrollSeparator,h.scrollSpeed)}function ie(a){if(m&&!v&&!W){if(!nb){if(sa){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();nb=!0;Aa.bind(Wa,function(a){a:{var c;if(sa){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches; else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c=a;a.preventDefault();cd(c)}}).bind(Xa,function(a){a:if(nb){nb=!1;Aa.unbind(Wa).unbind(Xa);var c;if(sa){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c= a;a.preventDefault();cd(c)}})}return!1}}function cd(a){"horizontal"==ob?A=Math.max(0,Math.min(1,(a.pageX-Ya.offset().left)/ba)):(A=Math.max(0,Math.min(1,(a.pageY-Ya.offset().top)/ba)),A=1-A);Za()}function qc(){if(!m||v)return!1;Sb?(A=rc,Sb=!1):(rc=A,A=0,Sb=!0)}function Za(){"horizontal"==ob?sc.css("width",A*ba+"px"):sc.css("height",A*ba+"px");P&&("youtube_single"==z||"youtube_playlist"==z?R?w&&w.setVolume(A):"undefined"!==typeof k(B)&&k(B).pb_setVolume(A):N?l&&(l.volume=A):"undefined"!==typeof k(p)&& k(p).pb_setVolume(A));0<A?e.find(".player_volume").find("img").attr("src",dd):e.find(".player_volume").find("img").attr("src",ed);isMobile&&pb&&(Q&&clearTimeout(Q),Q=setTimeout(Tb,Ub))}function tc(){pb&&Q&&clearTimeout(Q);wa.css("display","block");Z.bind("mousemove",fd).bind("mouseout",Vb);Aa.bind("mouseout",Vb)}function Vb(){pb&&(Q&&clearTimeout(Q),Q=setTimeout(Tb,Ub));wa.css("display","none");Z.unbind("mousemove",fd).unbind("mouseout",Vb);Aa.unbind("mouseout",Vb)}function fd(a){if("horizontal"== ob){var b=a.pageX-Ya.offset().left;if(!s(b))return!1;0>b?b=0:b>ba&&(b=ba);a=parseInt(a.pageX-Z.offset().left-wa.width()/2,10);wa.css("left",a+"px");b=Math.max(0,Math.min(1,b/ba));b=parseInt(100*b,10)}else{b=a.pageY-Ya.offset().top;if(!s(b))return!1;0>b?b=0:b>ba&&(b=ba);a=parseInt(b-wa.height()/2,10);wa.css("top",a+je+"px");b=Math.max(0,Math.min(1,b/ba));b=parseInt(100*(1-b),10)}wa.find("p").html(b+" %")}function gd(a){if(m&&!v&&P&&!nb&&!Wb){if(!W){if(sa){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault(); W=!0;Aa.bind(Wa,function(a){a:{var c;if(sa){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c=a;a.preventDefault();hd(c,a)}}).bind(Xa,function(a){ke(a)})}return!1}}function ke(a){if(W){W=!1;Aa.unbind(Wa).unbind(Xa);var b;if(sa){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches; else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else return!1;if(1<b.length)return!1;b=b[0]}else b=a;a.preventDefault();hd(b,a)}if(U)var c=setTimeout(function(){c&&clearTimeout(c);uc=!1},500);return!1}function hd(a,b){if(!U){La=a.pageX-Xb.offset().left;0>La?La=0:La>H&&(La=H);ha.width(La);var c=Math.max(0,Math.min(1,La/H))}else if(ia){if(vc(b)){if(wc||id>jd-le)return!1;W||(qb(!0),I.clearRect(0,0,$,ca),Ma(da),rb());return!1}if(!wc)return!1; uc=!0;var c=a.pageX-xa.offset().left-$/2,d=a.pageY-xa.offset().top-ca/2,c=Math.atan2(d,c);c>-1*Math.PI&&c<-.5*Math.PI&&(c=2*Math.PI+c);da=c=Math.max(0,Math.min((c+Math.PI/2)/2*Math.PI*10))/100;I.clearRect(0,0,$,ca);Ma(da);rb()}if(!s(c))return!1;sb=da;kd(c)}function kd(a){"youtube_single"==z||"youtube_playlist"==z?R?(a=(a*w.getDuration()).toFixed(1),s(a)&&w.seek(a)):"undefined"!==typeof k(B)&&k(B).pb_seek(a):N?l&&l.seekable&&0<l.seekable.length&&(!me||isMobile?l.currentTime=a*l.duration:a*l.duration>= l.buffered.end(0)-5?l.currentTime=l.buffered.end(0)-5:l.currentTime=a*l.duration):"undefined"!==typeof k(p)&&k(p).pb_seek(a)}function xc(){P&&(ja.css("display","block"),Ha.bind("mousemove",ld).bind("mouseout",Yb),Aa.bind("mouseout",Yb))}function Yb(){P&&(ja.css("display","none"),Ha.unbind("mousemove",ld).unbind("mouseout",Yb),Aa.unbind("mouseout",Yb))}function ld(a){if(!U){var b=a.pageX-Xb.offset().left;if(!s(b))return!1;0>b?b=0:b>H&&(b=H);a=parseInt(a.pageX-Ha.offset().left-ja.width()/2,10);ja.css("left", a+"px");b=Math.max(0,Math.min(1,b/H))}else if(ia){if(vc(a))return ja.css("display","none"),!1;b=a.pageX-xa.offset().left;a=a.pageY-xa.offset().top;a=Math.atan2(a-ca/2,b-$/2);a>-1*Math.PI&&a<-.5*Math.PI&&(a=2*Math.PI+a);b=Math.max(0,Math.min((a+Math.PI/2)/2*Math.PI*10))/100;ja.css("display","block")}if(!s(b))return!1;md(b)}function md(a){if(!s(a))return!1;var b,c;"youtube_single"==z||"youtube_playlist"==z?R?(c=w.getDuration(),b=a*c):"undefined"!==typeof k(B)&&(c=k(B).pb_getFlashDuration(),b=a*c):N? l&&(c=l.duration,b=a*c):"undefined"!==typeof k(p)&&(c=k(p).pb_getFlashDuration(),b=a*c);if(s(b)&&s(c))ja.find("p").html(tb(b)+nd+ub(c));else return!1}function Ma(a){I.beginPath();I.arc($/2,ca/2,yc-vb/2,-Zb,od*a-Zb,!1);I.strokeStyle=zc;I.lineCap="butt";I.lineWidth=vb;I.stroke()}function Ac(a){Ia.beginPath();Ia.arc($/2,ca/2,yc-vb/2,-Zb,od*a-Zb,!1);Ia.strokeStyle=ne;Ia.lineCap="butt";Ia.lineWidth=vb;Ia.stroke()}function rb(){if(C)a=62,b=57,I.fillStyle=zc,I.fillRect(a,b,14,45),I.fillRect(a+23,b,14,45); else{var a=65,b=57,c=65-a,d=102-b,f=Math.atan2(d,c)-Math.PI/3,d=Math.sqrt(c*c+d*d),c=Math.cos(f)*d+a,f=Math.sin(f)*d+b;I.beginPath();I.fillStyle=zc;I.moveTo(a,b);I.lineTo(65,102);I.lineTo(c,f);I.fill()}}function vc(a){var b;if(sa){if(a.originalEvent.touches&&a.originalEvent.touches.length)a=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)a=a.originalEvent.changedTouches;else return!1;if(1<a.length)return!1;b=a[0]}else b=a;a=b.pageX-xa.offset().left; b=b.pageY-xa.offset().top;var c=$/2,d=ca/2;id=Math.sqrt((a-c)*(a-c)+(b-d)*(b-d));return Math.sqrt((a-c)*(a-c)+(b-d)*(b-d))<jd}function Bc(a){0!=e.find(".componentPlaylist").length&&(S?"vertical"==wb?ya.outerHeight(!0)>=$a.height()?(S.reinitialise(),a&&(S.scrollToY(0),g(".jspPane").css("top","0px"))):(S.destroy(),S=null):(S.reinitialise(),a&&(S.scrollToX(0),g(".jspPane").css("left","0px"))):(a=e.find(".componentPlaylist"),S=a.jScrollPane().data().jsp,a.bind("jsp-initialised",function(a,c){}).jScrollPane({mouseWheelSpeed:20}), "horizontal"==wb&&(isMobile||a.bind("mousewheel",oe))))}function oe(a,b,c,d){if(!m||v)return!1;S&&S.scrollByX(100*(0<b?-1:1));return!1}function qb(a){if(C){if("youtube_single"==z||"youtube_playlist"==z){if(!Ba)return!1;R?w.togglePlayback():("undefined"!==typeof k(B)&&k(B).pb_togglePlayback(),P=!0)}else N?l&&l.pause():"undefined"!==typeof k(p)&&k(p).pb_pause();C=!1;ta("off")}else{if("youtube_single"==z||"youtube_playlist"==z){if(!Ba)return!1;R?isMobile?!xb&&X?(m=!1,$b("on")):w.togglePlayback():w.togglePlayback(): ("undefined"!==typeof k(B)&&k(B).pb_togglePlayback(),P=!0)}else N?l&&l.play():"undefined"!==typeof k(p)&&k(p).pb_play();C=!0;Na("off")}if(!a)return!1}function pd(a){if(!m||v)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=g(a.currentTarget);var b=a.attr("data-id");if(a.closest(".playlistItem").hasClass(yb))return!1;X=!0;za();q.processPlaylistRequest(b);return!1}function pe(a){if(!m||v)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble= !0:a.stopPropagation&&a.stopPropagation();a=g(a.currentTarget).attr("class").split(" ");if(-1!=g.inArray("controls_prev",a))X=!0,za(),q.advanceHandler(-1,!0);else if(-1!=g.inArray("controls_toggle",a)){if(!P)return;qb()}else if(-1!=g.inArray("controls_next",a))X=!0,za(),q.advanceHandler(1,!0);else if(-1!=g.inArray("player_volume",a))isMobile?pb?(Q&&clearTimeout(Q),zb?(Z.css("display","none"),zb=!1):(Z.css("display","block"),zb=!0,Q=setTimeout(Tb,Ub))):(qc(),Za()):(qc(),Za());else if(-1!=g.inArray("player_download", a)){if(!Ca)if(a=z){var b=q.getCounter(),c=y[b].download,b=Cc(b,!1);a=qd(a,b,c);rd(a.name,a.path)}else r&&alert("Invalid data-type for file download function! Quitting."),Ca=!1}else-1!=g.inArray("player_loop",a)?(ka?(e.find(".player_loop").find("img").attr("src",ac),ka=!1):(e.find(".player_loop").find("img").attr("src",Ab),ka=!0),q.setLooping(ka)):-1!=g.inArray("player_shuffle",a)&&(la?(e.find(".player_shuffle").find("img").attr("src",bc),la=!1):(e.find(".player_shuffle").find("img").attr("src",Bb), la=!0),q.setRandom(la));return!1}function qe(a){if(m)return a||(a=window.event),a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation(),a=g(a.currentTarget).attr("class").split(" "),-1!=g.inArray("controls_prev",a)?e.find(".controls_prev").find("img").attr("src",re):-1!=g.inArray("controls_toggle",a)?C?Na("on"):ta("on"):-1!=g.inArray("controls_next",a)?e.find(".controls_next").find("img").attr("src",se):-1!=g.inArray("player_volume",a)?0<A?e.find(".player_volume").find("img").attr("src", te):e.find(".player_volume").find("img").attr("src",ue):-1!=g.inArray("player_download",a)?e.find(".player_download").find("img").attr("src",ve):-1!=g.inArray("player_loop",a)?ka?e.find(".player_loop").find("img").attr("src",ac):e.find(".player_loop").find("img").attr("src",Ab):-1!=g.inArray("player_shuffle",a)&&(la?e.find(".player_shuffle").find("img").attr("src",bc):e.find(".player_shuffle").find("img").attr("src",Bb)),!1}function we(a){if(m)return a||(a=window.event),a.cancelBubble?a.cancelBubble= !0:a.stopPropagation&&a.stopPropagation(),a=g(a.currentTarget).attr("class").split(" "),-1!=g.inArray("controls_prev",a)?e.find(".controls_prev").find("img").attr("src",xe):-1!=g.inArray("controls_toggle",a)?C?Na("off"):ta("off"):-1!=g.inArray("controls_next",a)?e.find(".controls_next").find("img").attr("src",ye):-1!=g.inArray("player_volume",a)?0<A?e.find(".player_volume").find("img").attr("src",dd):e.find(".player_volume").find("img").attr("src",ed):-1!=g.inArray("player_download",a)?e.find(".player_download").find("img").attr("src", ze):-1!=g.inArray("player_loop",a)?ka?e.find(".player_loop").find("img").attr("src",Ab):e.find(".player_loop").find("img").attr("src",ac):-1!=g.inArray("player_shuffle",a)&&(la?e.find(".player_shuffle").find("img").attr("src",Bb):e.find(".player_shuffle").find("img").attr("src",bc)),!1}function za(){if(!ea&&-1!=q.getCounter()){var a=g(Da[q.getCounter()]);if(a&&a.hasClass("playlistSelected")){var b=a.attr("data-id");a.removeClass("playlistSelected").addClass("playlistNonSelected");"undefined"!==typeof playlistItemEnabled&& playlistItemEnabled(J,K,a,b)}}}function sd(){if(!ea){var a=g(Da[q.getCounter()]);if(a&&a.hasClass("playlistNonSelected")){var b=a.attr("data-id");a.removeClass("playlistNonSelected").addClass("playlistSelected");"undefined"!==typeof playlistItemDisabled&&playlistItemDisabled(J,K,a,b)}}}function Dc(){var a=h.activeItem;s(a)&&-1!=a?(0>a?a=0:a>D-1&&(a=D-1),q.setCounter(a,!1)):X=!0}function td(){u&&-1!=q.getCounter()&&(Cb(),ud(),za())}function Db(){Cb();ud();var a=0,b;for(a;a<D;a++)b=g(Da[a]).unbind("click", pd),vd&&!isMobile&&b.unbind("mouseenter").unbind("mouseleave");u&&(u.children().each(function(){var a=g(this);a.data("hap_wrap_player")&&a.data("hap_wrap_player").destroyPlaylist()}),u.empty(),u=null);ya.empty();ea=Eb=!1;cc=G=n=null;ab=bb=Fb=!1;cb=null;q.reSetCounter();y=[];Da=[];O=[];S&&S.reinitialise()}function Cb(){dc&&(R?w&&w.stop():"undefined"!==typeof k(B)&&k(B).pb_dispose(),dc=!1);N?(Y&&clearInterval(Y),l&&(l.pause(),l.src=""),Gb&&Gb.unbind("ended pause play canplay canplaythrough loadedmetadata")): "undefined"!==typeof k(p)&&k(p).pb_dispose();Ec();cc?ec.css("display","block"):ec.css("display","none");sb=null;Fc=P=C=Wb=!1;Gc||(Hb=void 0)}function wd(a){if("undefined"===typeof a)return r&&alert("setPlaylist method requires data parameter. loadPlaylist failed."),!1;if("undefined"===typeof a.hidden)return r&&alert("setPlaylist method requires data.hidden parameter. loadPlaylist failed."),!1;var b=Ae(a.hidden);if("undefined"===typeof a.id)return r&&alert("setPlaylist method requires data.id parameter. loadPlaylist failed."), !1;a=a.id;v=!0;xd||(xd=!0);yd();ya.css("opacity",0);u&&Db();Eb=!1;ea=b;zd&&isIE?(b=g(Ja.find(a).css("display","block").clone().wrap("<p>").parent().html()),g(Ja.find(a).css("display","none"))):(b=Ja.find(a).css("display","block").clone(),Ja.find(a).css("display","none"));b.css("fontSize",0);if(0==b.length)return r&&alert('Failed to select playlist! Make sure that element: "'+a+'" exist in playlist list! Quitting.'),Hc(),!1;if(ea)db.empty(),b.appendTo(db),ma=0,ab=bb=Oa=!0,u=Ic;else{if(!S&&0==ya.length)return r&& alert("playlist_inner html element seems to be missing! You could be trying to use loadPlaylist method without having necessary html elements inside componentWrapper. Quitting."),!1;b.appendTo(ya);u=b}y=[];Da=[];O=[];x=[];b.find("li[class*='playlistItem']").each(function(){x.push(g(this))});F()}function F(){x.length?Be():Ce()}function Be(){fc=M=L=G=V=null;Jc=!1;var a=x[0],b=a.attr("data-type").toLowerCase(),c=a.attr("data-path"),d=a.hasClass(Ad);t=[];a.hasClass(Bd)&&(Jc=!0);void 0==a.attr("data-plink")|| E(a.attr("data-plink"))||(V=a.attr("data-plink"));void 0!=a.attr("data-dlink")&&("youtube_single"==b||"youtube_playlist"==b?E(a.attr("data-dlink"))||(G=a.attr("data-dlink")):G=E(a.attr("data-dlink"))?!0:a.attr("data-dlink"));void 0!=a.attr("data-download")&&("youtube_single"==b||"youtube_playlist"==b?E(a.attr("data-download"))||(L=a.attr("data-download")):L=E(a.attr("data-download"))?!0:a.attr("data-download"));void 0==a.attr("data-thumb")||E(a.attr("data-thumb"))||(M=a.attr("data-thumb"));E(g.trim(a.html()))|| (fc=a.html());if(d)n=a,x.shift(),F();else if("local"==b)n=a,x.shift(),F();else if("soundcloud"==b)n=a.data("toremove","true"),Ib=0,gc(c);else if("podcast"==b)n=a.data("toremove","true"),d="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=xml&num="+De+"&callback=?&q="+encodeURIComponent(c),g.ajax({type:"GET",url:d,dataType:"jsonp",cache:!1}).done(function(a){if(null==a.responseData)r&&alert("Playlist process failed, podcast: "+c),n&&"true"==n.data("toremove")&&n.remove(),x.shift(),F(); else{if(ieBelow9){a=Ee(a.responseData.xmlString);var b;g(a).find("item").each(function(){b=g(this);h={type:"podcast"};h.mp3=b.find("enclosure").attr("url");h.ogg="";h.title=b.find("title").text();0<b.find("media\\:thumbnail").length?b.find("media\\:thumbnail").attr("url")?h.thumb=b.find("media\\:thumbnail").attr("url"):M&&(h.thumb=M):M&&(h.thumb=M);V&&(h.url=V);G&&(h.dlink=G);L&&(h.download=L);t.push(h)})}else{Cd.html(a.responseData.xmlString);a=Cd.get(0).getElementsByTagName("item");var d=0,f=a.length, e,k,h;for(d;d<f;d++)e=a[d],void 0!=e.getElementsByTagName("enclosure")[0]&&(h={type:"podcast"},h.mp3=e.getElementsByTagName("enclosure")[0].getAttribute("url"),h.ogg="",void 0!=e.getElementsByTagName("itunes:duration")[0]&&(k=Fe(e.getElementsByTagName("itunes:duration")[0].childNodes[0].nodeValue),h.length=parseInt(1E3*k,10)),void 0!=e.getElementsByTagName("media:thumbnail")[0]?void 0!=e.getElementsByTagName("media:thumbnail")[0].getAttribute("url")?h.thumb=e.getElementsByTagName("media:thumbnail")[0].getAttribute("url"): M&&(h.thumb=M):M&&(h.thumb=M),h.title=e.getElementsByTagName("title")[0].childNodes[0].nodeValue,V&&(h.url=V),G&&(h.dlink=G),L&&(h.download=L),t.push(h))}ua()}}).fail(function(a,b,d){r&&alert("Parse feed error: "+a.responseText);r&&alert("Playlist process failed, podcast: "+c);n&&"true"==n.data("toremove")&&n.remove();x.shift();F()});else if("folder"==b){n=a.data("toremove","true");var d=hap_source_path+"folder_parser.php",f=!0;void 0!=a.attr("data-subdirs")&&"false"==a.attr("data-subdirs")&&(f=!1); f={dir:c,subdirs:f};g.ajax({type:"GET",url:d,data:f,dataType:"json"}).done(function(a){Ge(a,"title");var b=0,c=a.length,d,f;Dd&&(Ka=t.length?t.length-1:0);for(b;b<c;b++)if(d=a[b],f=d.path,f=f.replace(/\\'/g,"'"),f=f.replace(/\\"/g,'"'),f=f.replace(/\\0/g,"\x00"),path=f=f.replace(/\\\\/g,"\\"),f={type:"folder"},/.mp3/.test(path)){f.mp3=path;f.ogg=path.substr(0,path.lastIndexOf("."))+".ogg";var g=path.substr(0,path.lastIndexOf("."));title=/\//i.test(g)?g.substr(g.lastIndexOf("/")+1):g;title=title.split("_").join(" "); f.title=title;f.thumb=path.substr(0,path.lastIndexOf("."))+".jpg";f.size=parseInt(d.size,10);f.lastmod=parseInt(d.lastmod,10);V&&(f.url=V);G&&(f.dlink=G);L&&(f.download=L);M&&(f.thumb=M);t.push(f)}t.length&&Dd?Ed():ua()}).fail(function(a,b,d){r&&alert("Read folder error! Make sure you run this online or on local server!");r&&alert("Playlist process failed, folder: "+c);n&&"true"==n.data("toremove")&&n.remove();x.shift();F()})}else if("xml"==b){n=a;var d=hap_source_path+c,e,k=[];g.ajax({type:"GET", url:d,dataType:"html",cache:!1}).done(function(b){x.shift();g(b).find("li[class='playlistItem']").each(function(){e=Kc(g(this));n?n.after(g(e)):0<u.children().size()?g(e).prependTo(u):g(e).appendTo(u);n=g(e);k.push(g(e))});b=0;var c=k.length;k.reverse();for(b;b<c;b++)x.unshift(k[b]);k=null;a.remove();F()}).fail(function(a,b,d){r&&alert("Playlist process failed, xml: "+c);n&&n.remove();x.shift();F()})}else if("database_data"==b||"database_html"==b)if(void 0==a.attr("data-table")||E(a.attr("data-table")))r&& (alert("Database table missing!"),alert("Playlist process failed, database query: "+c)),x.shift(),F();else{var h=f=null,m=null;void 0==a.attr("data-limit")||E(a.attr("data-limit"))||(f=parseInt(a.attr("data-limit"),10));void 0==a.attr("data-range")||E(a.attr("data-range"))||(d=a.attr("data-range").split(","),2==d.length&&(h=d[0],m=d[1]));n=a;d=hap_source_path+"includes/database.php";k=[];f={db_name:c,db_table:a.attr("data-table"),db_type:b,limit:f,range_from:h,range_to:m};g.ajax({type:"POST",url:d, data:f}).done(function(d){if(-1<d.indexOf("Database information missing!")||-1<d.indexOf("Db connection failed")||-1<d.indexOf("Db selection failed")||-1<d.indexOf("Db query failed"))r&&(alert(d),alert("Playlist process failed, database query: "+c)),n&&n.remove(),x.shift();else{x.shift();d=g.parseJSON(d);var f=0,h=d.length,m;for(f;f<h;f++){m=d[f];if("database_data"==b)if(m.type&&m.mp3||m.path)e=Fd(m);else continue;else if(m.path)e=Kc(m.path);else continue;n?n.after(g(e)):0<u.children().size()?g(e).prependTo(u): g(e).appendTo(u);n=g(e);k.push(g(e))}f=0;h=k.length;k.reverse();for(f;f<h;f++)x.unshift(k[f]);k=null;a.remove()}F()}).fail(function(a,b,d){r&&alert("Playlist process failed, database query: "+c);n&&n.remove();x.shift();F()})}else"youtube_single"==b?(Gd=c,youtube_path="http://gdata.youtube.com/feeds/api/videos/"+c+"?v=2&format=5&alt=jsonc",n=a.data("toremove","true"),Lc(b,youtube_path)):"youtube_playlist"==b?(c.substr(0,2).toUpperCase(),hc=c,eb=1,youtube_path="http://gdata.youtube.com/feeds/api/playlists/"+ hc+"?start-index="+eb+"&max-results=50&v=2&format=5&alt=jsonc",n=a.data("toremove","true"),Lc(b,youtube_path)):"ofm_single"==b?(n=a.data("toremove","true"),Ea=[],Ea.push({id:c,type:b}),Jb()):"ofm_playlist"==b||"ofm_project"==b?(n=a.data("toremove","true"),Mc=b,ic=c,Ea=[],fb=1,Hd()):(r&&alert("Invalid playlist data-type attribute!"),x.shift(),F())}function ua(){if(t.length){var a,b,c=0,d=t.length,f,e;for(c;c<d;c++)f=t[c],a=g('<li class="playlistItem" data-type="'+f.type+'"data-mp3="'+f.mp3+'" data-ogg="'+ f.ogg+'" data-thumb="'+f.thumb+'"></li>'),e=f.mp3,/\.(mp3)$/i.test(f.mp3)||(e+=".mp3"),Jc&&a.addClass(Bd),f.url&&a.attr("data-plink",f.url),f.dlink&&(!0!=f.dlink&&"true"!=f.dlink?a.attr("data-dlink",f.dlink):a.attr("data-dlink",e)),f.download&&(!0!=f.download&&"true"!=f.download?a.attr("data-download",f.download):a.attr("data-download",e)),f.title&&a.attr("data-title",f.title),f.thumb&&("//"==f.thumb.substr(0,2)&&(f.thumb="http:"+f.thumb),a.attr("data-thumb",f.thumb)),f.length&&a.attr("data-length", f.length),"title"==Fa?b=g('<a class="playlistNonSelected" href="#">'+f.title+"</a>").appendTo(a):"thumb"==Fa?b=g('<a class="playlistNonSelected" href="#"><img src="'+f.thumb+'" alt="thumb"/></a>').appendTo(a):"all"==Fa&&(b=g('<a class="playlistNonSelected" href="#"></a>').appendTo(a),g('<span class="hap_thumb"><img src="'+f.thumb+'" alt="thumb"/></span>').appendTo(b),g('<span class="hap_title"><p>'+f.title+"</p></span>").appendTo(b)),fc&&b.after(fc),n?(n.after(a),"true"==n.data("toremove")&&n.remove()): a.appendTo(u),n=a}x.shift();F()}function Ce(){if(Fb||bb){var a=0;n=null;var b;db.find("li[class*='playlistItem']").each(function(){b=g(this);n?n.after(b):Oa?b.appendTo(u):u.children().eq(ma).before(b);n=b;a++});db.empty()}jc();ya.css("opacity",1);m||Id();n=null;v=!1;Hc();if(0<D){if(Fb||bb){var c=q.getCounter();q.setPlaylistItems(D,!1);ma<=c&&(Oa||q.reSetCounter(c+a));ab&&(ab=!1,Dc())}else q.setPlaylistItems(D),Dc();Pa&&Ga()}bb=Fb=!1;0==D&&"undefined"!==typeof playlistEmpty&&playlistEmpty(J,K);"undefined"!== typeof audioPlayerPlaylistLoaded&&audioPlayerPlaylistLoaded(J,K);Eb=!0}function jc(){y=[];O=[];Da=[];if(0==u.length)return r&&alert("lastPlaylist html element seems to be missing! You could be trying to use addTrack method without having necessary html elements inside componentWrapper. Quitting."),!1;var a=0,b,c,d=u.find("li"),f=d.length,e,h,k,n,l,t,s,p,w,x;Kb=0;for(a;a<f;a++)c=g(d[a]).addClass(Ad),O.push(c),Nc&&c.addClass(yb),Kb="horizontal"==wb?Kb+c.outerWidth(!0):Kb+c.outerHeight(!0),b=c.find("a[class=playlistNonSelected]"), 0==b.length&&(b=c.find("a[class=playlistSelected]")),b.unbind().bind("click",pd).attr("data-id",a),Da.push(b),vd&&!isMobile&&b.bind("mouseenter",function(a){if(!m||v)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=g(a.currentTarget).attr("data-id");var b=g(Da[a]),c=!1;q.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollover&&playlistItemRollover(J,K,b,a,c);return!1}).bind("mouseleave",function(a){if(!m||v)return!1;a||(a=window.event); a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=g(a.currentTarget).attr("data-id");var b=g(Da[a]),c=!1;q.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollout&&playlistItemRollout(J,K,b,a,c);return!1}),e="",void 0!=c.attr("data-title")?e=c.attr("data-title"):"title"==Fa?e=b.html():"thumb"!=Fa&&"all"==Fa&&(e=b.find("span[class=hap_title]").find("p").html()),Oc&&(h=Pc(a)+Qc+e,b.html(h)),c=g(O[a]).attr({"data-id":a,"data-title":e}),k=h=t=l="",n=void 0,x=w=p=s=null, void 0!=c.attr("data-mp3")&&(l=c.attr("data-mp3")),void 0!=c.attr("data-ogg")&&(t=c.attr("data-ogg")),void 0!=c.attr("data-type")&&(h=c.attr("data-type")),void 0!=c.attr("data-origtype")&&(k=c.attr("data-origtype")),void 0==c.attr("data-length")||E(c.attr("data-length"))||(n=c.attr("data-length")),"youtube_single"==h||"youtube_playlist"==h?(void 0==c.attr("data-download")||E(c.attr("data-download"))||(s=c.attr("data-download")),void 0==c.attr("data-dlink")||E(c.attr("data-dlink"))||(p=c.attr("data-dlink"))): (void 0!=c.attr("data-download")&&(s=E(c.attr("data-download"))||"true"==c.attr("data-download")?l:c.attr("data-download")),void 0!=c.attr("data-dlink")&&(p=E(c.attr("data-dlink"))||"true"==c.attr("data-dlink")?l:c.attr("data-dlink"))),void 0==c.attr("data-plink")||E(c.attr("data-plink"))||(w=c.attr("data-plink")),void 0==c.attr("data-thumb")||E(c.attr("data-thumb"))||(x=c.attr("data-thumb")),ea||(w&&0==c.find("a[class=plink]").length&&(w=g('<a class="plink" href="'+w+'" target="_blank"><img src="'+ Jd+'" alt="purchase"/></a>'),b.after(w)),p&&0==c.find("a[class=dlink]").length&&(p=g('<a class="dlink" href="#" data-dlink="'+p+'"><img src="'+Kd+'" alt="download"/></a>'),b.after(p),E(c.attr("data-dlink"))),Ld&&0==c.find("a[class=premove]").length&&(c=g('<a class="premove" href="#"><img src="'+He+'" alt="remove"/></a>'),b.after(c))),y.push({id:a,type:h,origtype:k,title:e,mp3:l,ogg:t,length:n,download:s,thumb:x});d=null;D=y.length;ea||(Ie(),Je&&$a.length&&!u.hasClass("ui-sortable")&&(u.bind("sortstart", function(a,b){b.helper.css("margin-top",Md.scrollTop())}),u.bind("sortbeforestop",function(a,b){b.helper.css("margin-top",0)}),u.sortable({cursor:"move",update:function(a,b){jc();0<D&&q.setPlaylistItems(D);var c=ya.find("a[class=playlistSelected]").attr("data-id");c&&(q.reSetCounter(c),Pa&&Ga());1==D&&Dc()},receive:function(a,b){"undefined"!==typeof dropReceive&&dropReceive(J,K)}})),Nd&&("horizontal"==wb&&ya.width(Kb),Bc(!0)));return!0}function Id(){m=!0;v=!1;Hc();Od();"undefined"!==typeof audioPlayerSetupDone&& audioPlayerSetupDone(J,K)}function Ie(){var a=sa?Qa:"click";e.find("a[class=dlink]").unbind().bind(a,function(a){a.preventDefault();if(Ca)return!1;var c=g(this),d=c.closest(".playlistItem"),f=d.attr("data-id");if(d.hasClass(yb))return!1;if(void 0==d.attr("data-type")||E(d.attr("data-type")))return r&&alert("Invalid data-type for file download function! Quitting."),Ca=!1;a=d.attr("data-type");void 0==d.attr("data-origtype")||E(d.attr("data-origtype"))||(a=d.attr("data-origtype"));void 0==c.attr("data-dlink")|| E(c.attr("data-dlink"))||(c=c.attr("data-dlink"),f=Cc(f,!1),a=qd(a,f,c),rd(a.name,a.path))});e.find("a[class=plink]").unbind().bind("click",function(a){if(g(this).closest(".playlistItem").hasClass(yb))return!1});Ld&&e.find("a[class=premove]").unbind().bind("click",function(a){a.preventDefault();a=g(this).closest(".playlistItem");var c=parseInt(a.attr("data-id"),10);if(a.hasClass(yb))return!1;J.removeTrack(c)})}function qd(a,b,c){"local"==a||"folder"==a?(c.indexOf("\\")&&(c=c.replace(/\\/g,"/")),c.match(/^http([s]?):\/\/.*/)|| (a=window.location.href,a=a.substr(0,a.lastIndexOf("/")+1),/^\.\.\//i.test(c)&&(c=c.substr(3),"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.lastIndexOf("/"))),a=a.substr(0,a.lastIndexOf("/")+1)),c=a+c),isMobile||(b=0<c.lastIndexOf("/")?c.substr(c.lastIndexOf("/")+1):c)):"soundcloud"==a&&(c=c.replace(/\/stream\\?/,"/download").replace(/\.mp3/,""));b=b.replace(/[^A-Z0-9\-\_\.]+/ig,"_");/\.(mp3)$/i.test(b)||(b+=".mp3");return{name:b,path:c}}function rd(a,b){if(isMobile)if(Ca=!0,Ke)Pd||(Rc=Qd())&&(Pd=!0), Rc?Rd(Rc,a,b):Ca=!1;else{var c=Qd();c?Rd(c,a,b):Ca=!1}else Le.attr("src",hap_source_path+"dl.php?path="+b+"&name="+a)}function Rd(a,b,c){g.ajax({type:"POST",url:hap_source_path+"mail.php",data:"mail="+a+"&name="+b+"&path="+c}).done(function(a){Ca=!1}).fail(function(a,b,c){r&&alert("Send email error: "+a.responseText);Sd();Ca=!1});kc.css({marginTop:-kc.height()/2+"px",display:"block"}).stop().animate({opacity:1},{duration:500});Lb&&clearTimeout(Lb);Lb=setTimeout(Sd,Me)}function Sd(){Lb&&clearTimeout(Lb); kc.stop().animate({opacity:0},{duration:500,complete:function(){kc.css("display","none")}})}function Qd(){for(var a=prompt("Please enter your email address where download link will be sent:"),b=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;(!b.test(a)||E(a))&&null!=a;)a=prompt("Please enter a valid email address:");return a}function Ne(){g(".hap_text_link").each(function(){var a=g(this),b=a.attr("href");"undefined"!==typeof b&&!1!==b&&-1<b.toLowerCase().indexOf(".mp3")&&a.prepend('<img class="play_link" src="'+ lc+'"/>')});g(".hap_text_link, .hap_image_link").click(function(a){if(!m||v)return!1;a=g(this);var b=a.attr("href");if("undefined"===typeof b||!1===b)return!1;if(Hb&&Hb==b)return qb();za();q.reSetCounter();Hb=b;Td=a;Gc=!0;na&&na.attr("src",lc);a.hasClass("hap_text_link")&&(na=a.find("img").attr("src",Ud));aa=Hb;gb=aa.substr(0,aa.lastIndexOf("."))+".ogg";X=!0;N||"undefined"!==typeof k(p)&&k(p).pb_setAutoplay(!0);Cb();Sc();return Gc=!1})}function Jb(){Ea.length?Oe(Ea.shift()):(0==t.length&&n&&"true"== n.data("toremove")&&n.remove(),t.length>Mb&&(t=t.slice(0,Mb)),ua())}function Oe(a){var b=a.id,c=a.type;g.ajax({url:"http://api.official.fm/tracks/"+b+"?fields=streaming,cover&api_version=2",dataType:"json",cache:!1}).done(function(a){var b={},e,g;a.track&&a.track.streaming&&a.track.streaming.http&&(a=a.track,b.type=c,b.length=a.duration?a.duration:null,b.mp3=a.streaming.http,b.ogg=a.streaming.http,e=a.artist?a.artist:"Official Fm artist",g=a.title?a.title:"Official Fm track",b.title=e+" - "+g,V&& (b.url=V),G&&(b.dlink=G),L&&(b.download=L),a.cover.urls.small?b.thumb=a.cover.urls.small:M&&(b.thumb=M),t.push(b));Jb()}).fail(function(a,c,e){r&&alert("Playlist process failed, ofm: "+b);Jb()})}function Vd(){1<Tc?(fb+=1,fb<=Tc&&Ea.length<Mb?Hd():Ea.length?Jb():(x.shift(),F())):Ea.length?Jb():(0==t.length&&n&&"true"==n.data("toremove")&&n.remove(),x.shift(),F())}function Hd(){g.ajax({url:"ofm_playlist"==Mc?"http://api.official.fm/playlists/"+ic+"/tracks?api_version=2&page="+fb+"":"http://api.official.fm/projects/"+ ic+"/tracks?fields=cover&api_version=2&page="+fb+"",dataType:"json",cache:!1}).done(function(a){Tc=a.total_pages;if(a.tracks&&a.tracks.length){var b=0,c=a.tracks.length,d;c>Mb&&(c=Mb);for(b;b<c;b++)d=a.tracks[b].track,d.url&&(d=d.url.substr(d.url.lastIndexOf("/")+1),d=d.substr(0,d.indexOf("?")),Ea.push({id:d,type:Mc}))}Vd()}).fail(function(a,b,c){r&&alert("Playlist process failed, ofm: "+ic);Vd()})}function Lc(a,b){g.ajax({url:b,dataType:"jsonp",success:function(b){if("youtube_single"==a){var d={}; (b=b.data)?b.accessControl?(d.type="youtube_single",d.mp3=b.id,d.ogg="",d.title=b.title?b.title:"",d.description=b.description?b.description:"",b.thumbnail?d.thumb=b.thumbnail.hqDefault?b.thumbnail.hqDefault:b.thumbnail.sqDefault:M&&(d.thumb=M),V&&(d.url=V),G&&(d.dlink=G),L&&(d.download=L),t.push(d),ua()):(x.shift(),F()):(r&&alert("Playlist process failed, youtube single: "+Gd),n&&"true"==n.data("toremove")&&n.remove(),x.shift(),F())}else if(b.error)r&&alert("Playlist process failed, youtube playlist: "+ hc),n&&"true"==n.data("toremove")&&n.remove(),x.shift(),F();else if(b.data.items){var d=b.data.items.length,f=0,e;for(f;f<d;f++)d>Ra&&(d=Ra),(e=b.data.items[f].video)&&e.accessControl&&(obj={type:"youtube_playlist"},obj.mp3=e.id,obj.ogg="",obj.title=e.title?e.title:"",obj.description=e.description?e.description:"",e.thumbnail?obj.thumb=e.thumbnail.hqDefault?e.thumbnail.hqDefault:e.thumbnail.sqDefault:M&&(obj.thumb=M),V&&(obj.url=V),G&&(obj.dlink=G),L&&(obj.download=L),t.push(obj));eb<=Ra?(eb+=Pe, b="http://gdata.youtube.com/feeds/api/playlists/"+hc+"?start-index="+eb+"&max-results=50&v=2&format=5&alt=jsonc",Lc("youtube_playlist",b)):(t.length>Ra&&(t=t.slice(0,Ra)),ua())}else t.length>Ra&&(t=t.slice(0,Ra)),ua()},error:function(a){r&&alert("Playlist process failed, youtube: "+b);n&&"true"==n.data("toremove")&&n.remove();x.shift();F()}})}function Qe(){Wd?isMobile?xb?w.initVideo(aa):(m=!1,Uc=!0,$b("on")):w.initVideo(aa):(Nb=0==e.find("div[class='youtubeIframeMain']").length?g("<div/>").css({display:"block", left:"-10000px"}).addClass("youtubeIframeMain").appendTo(e):e.find("div[class='youtubeIframeMain']"),w=g.youtubePlayer({parent:J,autoPlay:Xd,defaultVolume:A,mediaPath:aa,youtubeHolder:Nb,youtubeChromeless:Re,isMobile:isMobile,initialAutoplay:Se,quality:Te}),g(w).bind("ap_YoutubePlayer.YT_READY",function(){Vc||Nb.css("left","-10000px");Ba=!0}),g(w).bind("ap_YoutubePlayer.START_PLAY",function(){Y&&clearInterval(Y);Y=setInterval(Ue,Wc);Uc&&(w.stop(),w.initVideo(aa),Uc=!1);!xb&&isMobile&&($b("off"),m= xb=!0)}),g(w).bind("ap_YoutubePlayer.END_PLAY",function(){mc()}),g(w).bind("ap_YoutubePlayer.STATE_PLAYING",function(){nc()}),g(w).bind("ap_YoutubePlayer.STATE_PAUSED",function(){isMobile?"iPhone"==hb||"iPod"==hb?C&&(C=!1,ta("off")):oc():oc()}),Wd=!0);P=dc=!0}function $b(a){"on"==a?(Vc=!0,Nb.css({top:"0px",left:"0px"})):(Nb.css("left","-10000px"),Vc=null)}function Ve(){var a=B.substr(1);embedFlashMain(a);a=p.substr(1);embedFlashAudio(a);"undefined"!==typeof k(B)?oa=setInterval(We,pc):(r&&alert("Problems with flash initialization (startFlashInit)! Flash for youtube not initialized! Sound_id: "+ K),Yd())}function We(){void 0!=k(B).setData&&(oa&&clearInterval(oa),k(B).setData(h),e.find(".flashMain").css("left","-10000px"),Yd())}function Yd(){"undefined"!==typeof k(p)?oa=setInterval(Xe,pc):(r&&alert("Problems with flash initialization (checkFlashSound)! Flash audio backup not initialized! Sound_id: "+K),Zd())}function Ye(){var a=p.substr(1);embedFlashAudio(a);var b=setTimeout(function(){b&&clearTimeout(b);"undefined"!==typeof k(p)?oa=setInterval(Ze,pc):(r&&alert("Problems with flash initialization (checkFlashSound_b)! Flash audio backup not initialized! Sound_id: "+ K),ib())},500)}function Xe(){void 0!=k(p).setData&&(oa&&clearInterval(oa),k(p).setData(h),e.find(".flashAudio").css("left","-10000px"),Zd())}function Ze(){void 0!=k(p).setData&&(oa&&clearInterval(oa),k(p).setData(h),e.find(".flashAudio").css("left","-10000px"),ib())}function Zd(){if(U){var a=T.substr(1);embedFlashCircle(a);"undefined"!==typeof k(T)?oa=setInterval($e,pc):(r&&alert("Problems with flash initialization (checkFlashCircle)! Flash circle backup (canvas support is false) not initialized! Sound_id: "+ K),ib())}else g(".circleMain").remove(),ib()}function $e(){void 0!=k(T).setData&&(oa&&clearInterval(oa),k(T).setData(jb),ib())}function k(a){"#"==a.charAt(0)&&(a=a.substr(1));return-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a]}function gc(a){if(E(Xc))return alert("soundcloudApiKey has not been set! Skipping Soundcloud url."),x.shift(),F(),!1;/\/likes$/.test(a)&&(a=a.replace(/\/likes$/,"/favorites"));var b=af(a,Xc);g.ajax({url:b,dataType:"jsonp",cache:!1}).done(function(b){var d, f;if(b.tracks){d=b.tracks.length;d>fa&&(d=fa);for(f=0;f<d;f++)b.tracks[f].streamable&&b.tracks[f].stream_url?t.push(Yc(b.tracks[f])):(d+=1,d>b.tracks.length&&(d=b.tracks.length));t.length>fa&&(t=t.slice(0,fa));ua()}else if(b.duration)b.permalink_url=a,b.streamable&&b.stream_url&&t.push(Yc(b)),t.length>fa&&(t=t.slice(0,fa)),ua();else if(b.username)Ob=/likes/.test(a)?b.uri+"/likes":/favorites/.test(a)?b.uri+"/favorites":b.uri+"/tracks",gc(Ob);else if(g.isArray(b)){d=b.length;d>fa&&(d=fa);for(f=0;f< d;f++)b[f].streamable&&b[f].stream_url?t.push(Yc(b[f])):(d+=1,d>b.length&&(d=b.length));d==$d?(Ib+=$d,Ib<fa?gc(Ob):(t.length>fa&&(t=t.slice(0,fa)),ua())):(t.length>fa&&(t=t.slice(0,fa)),ua())}else b.kind&&"group"==b.kind?(Ob=b.uri+"/tracks",gc(Ob)):(x.shift(),F())}).fail(function(b,d,f){r&&alert("Playlist process failed, soundcloud: "+a);x.shift();F()})}function Yc(a){var b={type:"soundcloud"};a.duration&&(b.length=a.duration);b.mp3=a.stream_url+(/\?/.test(a.stream_url)?"&":"?")+"consumer_key="+Xc; b.ogg="";b.title=a.title;V&&(b.url=V);a.downloadable&&a.download_url?(G&&(b.dlink=G),L&&(b.download=L)):(G&&!0!=G&&"true"!=G&&(b.dlink=G),L&&!0!=L&&"true"!=L&&(b.download=L));a.artwork_url?b.thumb=a.artwork_url:M&&(b.thumb=M);return b}function af(a,b){return(/api\./.test(a)?a+"?":"http://api.soundcloud.com/resolve?url="+a+"&")+"format=json&offset="+Ib+"&consumer_key="+b+"&callback=?"}function Ed(){var a=t[Ka].mp3+"?rand="+99999999*Math.random();ID3.loadTags(a,function(){var b=ID3.getAllTags(a);b.title&& (t[Ka].title=b.title);b.artist&&(t[Ka].artist=b.artist);b.album&&(t[Ka].album=b.album);if(b=b.picture){var c="",d=0,f=b.data.length;for(d;d<f;d++)c+=String.fromCharCode(b.data[d]);t[Ka].thumb="data:"+b.format+";base64,"+window.btoa(c)}Ka++;Ka<t.length?Ed():ua()},{tags:["title","artist","album","picture"],onError:function(a){}})}function Ue(){if(R){var a=w.getCurrentTime(),b=w.getDuration();pa=w.getVideoBytesLoaded()/w.getVideoBytesTotal();s(a)&&s(b)?(Wb=!1,qa.html(tb(a)+Sa),ra.html(ub(b)),U)?ia&& (s(pa)&&Ac(pa),da=a/b,!W&&C&&(uc||Ma(a/b))):(s(pa)&&va.width(pa*H),W||ha.width(a/b*H)):Wb=!0}}function ae(){var a=l.currentTime,b=l.duration;void 0!=l.buffered&&0!=l.buffered.length&&s(b)&&(pa=l.buffered.end(0)/b);s(a)&&s(b)&&(qa&&qa.html(tb(a)+Sa),ra&&ra.html(ub(b)));if(U)ia&&(s(pa)&&Ac(pa),s(a)&&s(b)&&(da=a/b,!W&&C&&Ma(a/b)));else{if(s(pa)){var c=pa*H;c>H&&(c=H);va&&va.width(c)}s(a)&&s(b)&&!W&&ha&&ha.width(a/b*H)}}function mc(){"undefined"!==typeof audioPlayerSoundEnd&&audioPlayerSoundEnd(J,K,q.getCounter()); za();q.advanceHandler(1,!0)}function nc(){Fc||("undefined"!==typeof audioPlayerSoundStart&&audioPlayerSoundStart(J,K,q.getCounter()),Fc=!0);"undefined"!==typeof audioPlayerSoundPlay&&audioPlayerSoundPlay(J,K,q.getCounter());U&&ia&&rb()}function oc(){"undefined"!==typeof audioPlayerSoundPause&&audioPlayerSoundPause(J,K,q.getCounter())}function Sc(){if("youtube_single"==z||"youtube_playlist"==z)R?(Qe(),isMobile&&!xb&&X&&(m=!1,$b("on"))):("undefined"!==typeof k(B)&&(k(B).pb_play(aa,0,100,100,"youtube", X),P=!0),dc=Ba=!0);else if(N){if(!be){var a="",a=bf?a+'<audio class="hap_audio_cont" preload="auto">':a+'<audio class="hap_audio_cont" preload="none">';ce.html(a+"</audio>");Gb=ce.find(".hap_audio_cont");l=Gb[0];l.volume=A;be=!0}Ta?l.src=aa:Pb&&(l.src=gb);X&&(l.load(),l.play());Gb.bind("ended",function(a){mc()}).bind("pause",function(a){oc()}).bind("play",function(a){Y&&clearInterval(Y);Y=setInterval(ae,Wc);nc()}).bind("canplay",function(a){sb&&(l.seekable&&0<l.seekable.length&&(l.currentTime=sb* l.duration),sb=null)}).bind("canplaythrough",function(a){}).bind("loadedmetadata",function(a){}).bind("error",function(a){}).bind("abort",function(a){}).bind("stalled",function(a){}).bind("suspend",function(a){});Y&&clearInterval(Y);Y=setInterval(ae,Wc)}else"undefined"!==typeof k(p)&&k(p).pb_initAudio(aa);X?(C=!0,Na("off")):(C=!1,ta("off"));Za();"youtube_single"!=z&&"youtube_playlist"!=z&&(P=!0);X=!0;!isMobile&&w&&w.setAutoPlay(!0)}function ib(){var a=[e.find(".controls_next"),e.find(".controls_prev"), e.find(".controls_toggle"),e.find(".player_volume"),e.find(".player_download"),e.find(".player_loop"),e.find(".player_shuffle")],b,c=a.length,d=0;for(d;d<c;d++)b=g(a[d]).css("cursor","pointer").bind(Qa,pe),cf&&!isMobile&&b.bind("mouseover",qe).bind("mouseout",we);Ne();cb?wd(cb):m||Id()}function Od(){if(!U&&(H=Xb.width(),s(pa)&&va&&va.width(pa*H),!W&&ha)){var a,b;if("youtube_single"!=z&&"youtube_playlist"!=z){if(N)l&&(a=l.currentTime,b=l.duration);else if("undefined"!==typeof k(p))try{a=k(p).pb_getFlashPosition, b=k(p).pb_getFlashDuration()}catch(c){}try{a&&s(a)&&b&&s(b)&&ha.width(a/b*H)}catch(d){}}}Nd&&!ea&&Bc();kb&&ga&&ga.checkSize()}function Hc(){de.css("display","none")}function yd(){de.css("display","block")}function ud(){Y&&clearInterval(Y);kb&&ga&&ga.deactivate();Va.html(Qb);qa.html(Zc+Sa);ra.html($c);U?ia&&(da=0,I.clearRect(0,0,$,ca),Ia.clearRect(0,0,$,ca)):(ha.width(0),va.width(0));ta("off");ec.css("display","none")}function Ec(){Y&&clearInterval(Y);Pa||(kb&&ga&&ga.deactivate(),Va.html(Qb));qa.html(Zc+ Sa);ra.html($c);U?ia&&(da=0,I.clearRect(0,0,$,ca),Ia.clearRect(0,0,$,ca)):(ha.width(0),va.width(0));ta("off");ec.css("display","none")}function ta(a){"on"==a?e.find(".controls_toggle").find("img").attr("src",df):e.find(".controls_toggle").find("img").attr("src",ef);na&&na.hasClass("play_link")&&na.attr("src",lc);U&&(ia?(I.clearRect(0,0,$,ca),Ma(da),rb()):"undefined"!==typeof k(T)&&k(T).pb_toggle_icon("play"))}function Na(a){"on"==a?e.find(".controls_toggle").find("img").attr("src",ff):e.find(".controls_toggle").find("img").attr("src", gf);na&&na.hasClass("play_link")&&Td.hasClass("hap_text_link")&&na.attr("src",Ud);U&&(ia?(I.clearRect(0,0,$,ca),Ma(da),rb()):"undefined"!==typeof k(T)&&k(T).pb_toggle_icon("pause"))}function s(a){return!isNaN(parseFloat(a))&&isFinite(a)}function tb(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function ub(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60); return minutes+":"+(10<=a?a:"0"+a)}function Ga(a){if("string"===typeof a){if(Oc&&q&&-1!=q.getCounter()){var b=q.getCounter();a=Pc(y[b].id)+Qc+a}}else{if("number"===typeof a){if(!q||0>a||a>D-1)return!1}else if(!q)return!1;b=q.getCounter();a=Cc(b)}kb&&ga?(ga.input(a),ga.activate()):Va&&Va.html(a)}function Cc(a,b){if("undefined"===typeof b||null===b)b=!0;return y[a]&&y[a].title&&!E(y[a].title)?b?Oc?Pc(y[a].id)+Qc+y[a].title:y[a].title:y[a].title:Qb}function Pc(a){return 9>a?"0"+(a+1):a+1}function hf(a){var b= [],c=[],d=0;for(d;d<a;d++)b[d]=d;var d=0,f;for(d;d<a;d++)f=Math.round(Math.random()*(b.length-1)),c[d]=b[f],b.splice(f,1);return c}function jf(a){var b=[],c=0;for(c;c<a;c++)b[c]=c;return b}function Ge(a,b,c){"title"==b?a.sort(function(a,b){return a.title==b.title?0:a.title<b.title?-1:1}):"type"==b&&a.sort(function(a,b){return a.type==b.type?0:a.type<b.type?-1:1});c&&a.reverse()}function E(a){return a?0==a.replace(/^\s+|\s+$/g,"").length:!0}function Fe(a){a=a.split(":");for(var b=0,c=1;0<a.length;)b+= c*parseInt(a.pop()),c*=60;return b}function Ee(a){if(window.ActiveXObject&&window.GetObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.loadXML(a);return b}if(window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");throw Error("No XML parser available");}function kf(a,b){return b-a}function Ae(a){if("string"===typeof a)switch(a.toLowerCase()){case "true":case "yes":case "1":return!0;case "false":case "no":case "0":case null:return!1;default:return Boolean(a)}else if("boolean"===typeof a)return Boolean(a)} function lf(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}function Fd(a){var b,c="",d,f="",e="",h="",k,m,n,l;b=a.type.toLowerCase();a.origtype&&(c=a.origtype.toLowerCase());a.mp3?d=a.mp3:a.path&&(d=a.path);a.ogg&&(f=a.ogg);a.title&&(e=a.title);a.thumb&&(h=a.thumb);a.download&&("youtube_single"==b||"youtube_playlist"==b?!0==a.download||"true"==a.download||E(a.download)||(k=a.download):k=!0==a.download?d:a.download);a.url&&(n=a.url);a.dlink&&("youtube_single"== b||"youtube_playlist"==b?!0==a.dlink||"true"==a.dlink||E(a.dlink)||(m=a.dlink):m=!0==a.dlink?d:a.dlink);"local"==b?"title"==Fa?l="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+d+"' data-ogg='"+f+"' data-thumb='"+h+"' data-title='"+e+"'><a class='playlistNonSelected' href='#'>"+e+"</a></li>":"thumb"==Fa?l="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+d+"' data-ogg='"+f+"' data-thumb='"+h+"' data-title='"+e+"'><a class='playlistNonSelected' href='#'><img src='"+ h+"' alt='thumb'/></a></li>":"all"==Fa&&(l="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+d+"' data-ogg='"+f+"' data-thumb='"+h+"' data-title='"+e+"'><a class='playlistNonSelected' href='#'><span class='hap_thumb'><img src='"+h+"' alt='thumb'/></span><span class='hap_title'><p>'"+e+"'</p></span></a></li>"):(l="<li class= 'playlistItem' data-type='"+b+"' data-path='"+d+"' data-thumb='"+h+"'></li>","database_data"==b&&(d=a.table?a.table:null,c=a.limit?a.limit:null,a= a.range?a.range:null,d&&(d=' data-table="'+d+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index)),c&&(d=' data-limit="'+c+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index)),a&&(d=' data-range="'+a+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index))));k&&(d=' data-download="'+k+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index));"local"==b?(m&&(d="<a class='dlink' href='#' data-dlink='"+m+"'><img src='"+Kd+"' alt='download'/></a>",f=l.match(/\<\/a\>\<\/li\>/), l=l.slice(0,f.index)+d+l.slice(f.index)),n&&(d="<a class='plink' href='"+n+"' target='_blank'><img src='"+Jd+"' alt='purchase'/></a>",f=l.match(/\<\/a\>\<\/li\>/),l=l.slice(0,f.index)+d+l.slice(f.index))):(m&&(d=' data-dlink="'+m+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index)),n&&(d=' data-plink="'+n+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index)));b=document.createElement("ul");b.innerHTML=l;return g(b.firstChild)}function Kc(a){a=g(a);var b;a=g("<div>").append(a.clone()).html(); b=document.createElement("ul");b.innerHTML=a;return g(b.firstChild)}function lb(a){D=y.length;if(0<D){jc();var b=q.getCounter();a==b?(td(),q.setPlaylistItems(D)):(q.setPlaylistItems(D,!1),a<b&&q.reSetCounter(q.getCounter()-1));Pa&&Ga()}else Db(),cb=null,"undefined"!==typeof playlistEmpty&&playlistEmpty(J,K)}var m=!1,J=this;if(function(){var a=!1,b=document.URL,c=b.indexOf("://")+3,d=b.indexOf("/",c),b=b.substring(c,d).split("."),c=[1059,653,969,1728],d=[],f,e,g,h,k=b.length,l,m;for(f=0;f<k;f++){m= b[f];l=m.length;g=e=0;for(e;e<l;e++)h=m.charAt(e),g+=h.charCodeAt(0);d.push(g)}f=0;k=d.length;l=c.length;f;a:for(;f<k;f++)for(e=0,e;e<l;e++)if(d[f]==c[e]){a=!0;break a}return a}()){g("body");var Md=g(window),Aa=g(document),ad,mb=navigator.userAgent,hb;if(-1<mb.indexOf("iPhone")||-1<mb.indexOf("iPod")||-1<mb.indexOf("iPad"))-1<mb.indexOf("iPhone")?hb="iPhone":-1<mb.indexOf("iPod")?hb="iPod":-1<mb.indexOf("iPad")&&(hb="iPad");var me=-1<navigator.userAgent.toLowerCase().indexOf("safari/"),Rb=document.createElement("audio"), Ta,Pb,R=!1;Rb.canPlayType?(R=!0,Ta=!!Rb.canPlayType&&""!=Rb.canPlayType("audio/mpeg"),Pb=!!Rb.canPlayType&&""!=Rb.canPlayType('audio/ogg; codecs="vorbis"')):(Ta=!0,Pb=!1);var xe=hap_source_path+h.buttonsUrl.prev,re=hap_source_path+h.buttonsUrl.prevOn,ye=hap_source_path+h.buttonsUrl.next,se=hap_source_path+h.buttonsUrl.nextOn,ef=hap_source_path+h.buttonsUrl.play,df=hap_source_path+h.buttonsUrl.playOn,gf=hap_source_path+h.buttonsUrl.pause,ff=hap_source_path+h.buttonsUrl.pauseOn,ac=hap_source_path+h.buttonsUrl.loop, Ab=hap_source_path+h.buttonsUrl.loopOn,dd=hap_source_path+h.buttonsUrl.volume,te=hap_source_path+h.buttonsUrl.volumeOn,ed=hap_source_path+h.buttonsUrl.mute,ue=hap_source_path+h.buttonsUrl.muteOn,bc=hap_source_path+h.buttonsUrl.shuffle,Bb=hap_source_path+h.buttonsUrl.shuffleOn,ze=hap_source_path+h.buttonsUrl.download,ve=hap_source_path+h.buttonsUrl.downloadOn,Jd=hap_source_path+h.buttonsUrl.trackUrlIcon,Kd=hap_source_path+h.buttonsUrl.trackDownloadIcon,He=hap_source_path+h.buttonsUrl.trackRemoveIcon, Ud=hap_source_path+h.buttonsUrl.link_pause,lc=hap_source_path+h.buttonsUrl.link_play,e=g(this).css("display","block"),U=e.hasClass("hap_circle"),ia=!1;R&&lf()&&(ia=!0);var zd="html5audio-popup"==e.attr("id"),$a=e.find(".playlistHolder"),ya=e.find(".playlist_inner").css("opacity",0);e.find(".playerHolder");e.find(".player_mediaTime");var qa=e.find(".player_mediaTime_current"),ra=e.find(".player_mediaTime_total"),he=e.find(".player_mediaName_Mask"),Va=e.find(".player_mediaName");e.find(".player_controls"); var mf=e.find(".player_volume"),de=e.find(".preloader"),ec=e.find(".player_download");e.find(".componentPlaylist");var Ja=g(h.playlistList);zd&&window.opener&&(Ja=window.opener.jQuery(h.playlistList));var K=h.sound_id,X=h.autoPlay,Se=h.autoPlay,Xd=h.autoPlay,bf=h.autoLoad;isMobile&&(X=!1,Xd=h.autoPlay=!1);var nf=h.useOnlyMp3Format,Xc=h.soundcloudApiKey,fa=h.soundcloud_result_limit,De=h.podcast_result_limit,Ra=h.yt_playlist_result_limit,Mb=h.ofm_result_limit,kb=h.useSongNameScroll,Pa=h.autoSetSongTitle, ka=h.loopingOn,la=h.randomPlay,Sa=h.mediaTimeSeparator,nd=h.seekTooltipSeparator,Qb=h.defaultArtistData,Oc=h.useNumbersInPlaylist,Qc=h.titleSeparator,cb=h.activePlaylist,r=h.useAlertMessaging,Nd=h.activatePlaylistScroll,wb=h.playlistScrollOrientation.toLowerCase(),Je=h.sortablePlaylistItems,Ke=h.autoReuseMailForDownload,Ld=h.useRemoveBtnInTracks,of=h.useVolumeTooltip,pf=h.useSeekbarTooltip,Fa=h.playlistItemContent.toLowerCase(),qf=h.useKeyboardNavigation,cf=h.useBtnRollovers,vd=h.usePlaylistRollovers, Dd=h.getTrackInfoFromID3;qa.html("0:00");ra.html("0:00");var Zc=qa.html(),$c=ra.html();Va.html(Qb);qa.html(Zc+Sa);ra.html($c);var N=!0;if(!R||!Ta&&nf)N=!1;var Ka,Oa,ma,Fb,bb,ab,ea=!1,Ad="hap_processed",Bd="hap_draggable",Jc,V,Pd,Rc,Ca,G,L,cc,M,fc,Td,na,Hb,Gc,Nc=!1;void 0!=$a.attr("data-playlistLocked")&&(Nc=!0);var yb="playlist_locked",Eb=!1,Kb,n,u=null,v=!0,Wb=!1,Fc=!1,Ob,Ib,$d=50,z,P=!1,aa="",gb="",C=!1,Wc=250,Y,pa;ka&&e.find(".player_loop").find("img").attr("src",Ab);la&&e.find(".player_shuffle").find("img").attr("src", Bb);var y=[],Da=[],O=[],D=0,S,xd,Cd=g('<div class="hap_feedParser"/>'),Le=0==e.find("iframe[id='dl_iframe']").length?g('<iframe id="dl_iframe"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(e):e.find("iframe[id='dl_iframe']"),db=g("<div/>"),Ic=g("<div/>");if(isMobile)var Lb,Me=1E3,kc=0==$a.find("div[id='download_confirm']").length?g('<div id="download_confirm"><p>DOWNLOAD STARTING</p></DIV>').addClass("download_confirm").css({opacity:0,zIndex:1E3}).appendTo($a):$a.find("div[id='download_confirm']"); var t=[],x=[],p=h.flashAudio,T=h.circleMain;if(N)var be=!1,Gb,l,ce=g('<div class="hap_audioHolder"/>');var w,eb,Pe=50,hc,Wd=!1,Re=!1,Gd,Nb,B=h.flashYoutube,Te=!1,pc=100,oa,dc=!1,Ba=!1,xb=!1,Vc,Uc=!1,Ea=[],Mc,ic,fb,Tc,ga;kb&&ge();var q=g.playlistManager({randomPlay:la,loopingOn:ka});g(q).bind("ap_PlaylistManager.COUNTER_READY",function(){var a=q.getCounter(),b=y[a];b&&!Nc&&(sd(),Pa&&Ga(),z=b.origtype?b.origtype:b.type,aa=b.mp3,gb=b.ogg,b.download?cc=!0:cc=null,Cb(),Sc(),"undefined"!==typeof itemTriggered&& itemTriggered(J,K,a))});g(q).bind("ap_PlaylistManager.PLAYLIST_END",function(){sd();"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(J,K);C=!1;ta("off")});g(q).bind("ap_PlaylistManager.PLAYLIST_END_ALERT",function(){"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(J,K)});var Qa="",Wa="",Xa="",sa;"ontouchstart"in window?(sa=!0,Qa="touchstart.ap",Wa="touchmove.ap",Xa="touchend.ap"):(sa=!1,Qa="mousedown.ap",Wa="mousemove.ap",Xa="mouseup.ap");var pb=!1,rc,Sb=!1,A= h.defaultVolume;0>A&&(A=0);0==A?rc=.5:1<A&&(A=1);var Z=e.find(".volume_seekbar").css("cursor","pointer").bind(Qa,function(a){ie(a);return Sb=!1}),ob="horizontal";void 0!=Z.attr("data-orientation")&&(ob=Z.attr("data-orientation").toLowerCase());if(void 0!=Z.attr("data-autoHide")){var pb=!0,zb=!1,Q,Ub=parseInt(Z.attr("data-autoHide"),10),Tb=function(){Q&&clearTimeout(Q);Z.css("display","none");zb=!1};isMobile||mf.bind("mouseover",function(){if(!m)return!1;Q&&clearTimeout(Q);Z.css("display","block"); zb=!0;return!1}).bind("mouseout",function(){if(!m)return!1;Q&&clearTimeout(Q);Q=setTimeout(Tb,Ub);return!1})}var nb=!1,Ya=e.find(".volume_bg");if("horizontal"==ob)var ba=Ya.width(),sc=e.find(".volume_level").css("width",A*ba+"px");else ba=Ya.height(),sc=e.find(".volume_level").css("height",A*ba+"px");if(of&&!isMobile){Z.bind("mouseover",tc);var wa=e.find(".player_volume_tooltip"),je=parseInt(wa.css("top"),10);wa.bind("mouseenter",function(){Z.unbind("mouseover",tc);wa.css("display","none")}).bind("mouseleave", function(){Z.bind("mouseover",tc)})}else e.find(".player_volume_tooltip").remove();var La,sb,W=!1,Xb=e.find(".progress_bg"),va=e.find(".load_progress"),ha=e.find(".play_progress"),Ha=e.find(".player_progress"),H=Xb.width(),uc=!1;if(U){var Ua=e.find(".load_canvas").css("cursor","pointer"),bd=e.find(".play_canvas"),xa=e.find(".circlePlayer"),ee=parseFloat(xa.attr("data-offOpacity"),10),fe=parseFloat(xa.attr("data-onOpacity"),10);isMobile&&(ee=fe=1);var jb={flash_id:h.flash_id,strokeSize:parseInt(xa.attr("data-strokeSize"), 10),play_color:bd.attr("data-bgcolor"),load_color:Ua.attr("data-bgcolor"),tolerance:parseInt(xa.attr("data-tolerance"),10),offOpacity:ee,onOpacity:fe,circleWidth:Ua.width(),circleHeight:Ua.height()};if(ia){var vb=jb.strokeSize,zc=jb.play_color,ne=jb.load_color,I=Ua[0].getContext("2d"),Ia=bd[0].getContext("2d"),od=2*Math.PI,Zb=Math.PI/2,$=jb.circleWidth,ca=jb.circleHeight,yc=$/2,jd=yc-vb,le=h.tolerance,id,wc=!1,da=0;Ua.bind(Qa,function(a){wc=vc(a)?!1:!0;gd(a);return!1});Ha=Ua}else Ua.remove(),bd.remove()}else Ha= e.find(".player_progress").css("cursor","pointer").bind(Qa,function(a){gd(a);return!1});if(pf&&!isMobile){Ha.bind("mouseover",xc);var ja=e.find(".player_progress_tooltip").css("zIndex",50);ja.find("p").html("0:00"+nd+"0:00");ja.bind("mouseenter",function(){Ha.unbind("mouseover",xc);ja.css("display","none")}).bind("mouseleave",function(){Ha.bind("mouseover",xc)})}else e.find(".player_progress_tooltip").remove();this.flashVideoPause=function(){ta("off");C=!1;oc()};this.flashVideoResume=function(){Na("off"); C=!0;nc()};this.flashVideoEnd=function(){mc()};this.flashVideoStart=function(){Na("off");P=C=!0;nc()};this.flashYoutubeData=function(a,b,c,d){U?(s(a)&&s(b)&&"undefined"!==typeof k(T)&&k(T).pb_drawLoadbar(a/b),s(c)&&s(d)&&(da=c/d,W||"undefined"!==typeof k(T)&&k(T).pb_drawSeekbar(c/d))):(s(a)&&s(b)&&va&&va.width(a/b*H),s(c)&&s(d)&&ha&&ha.width(c/d*H));s(c)&&s(d)&&(qa&&qa.html(tb(c)+Sa),ra&&ra.html(ub(d)))};this.flashAudioData=function(a,b,c,d){a/=b;U?ia?(s(a)&&Ac(a),s(c)&&s(d)&&(da=c/d,!W&&C&&Ma(c/ d))):(null!==a&&"undefined"!==typeof k(T)&&k(T).pb_drawLoadbar(a),s(c)&&s(d)&&(da=c/d,W||"undefined"!==typeof k(T)&&k(T).pb_drawSeekbar(c/d))):(!W&&ha&&ha.width(c/d*H),null!==a&&(a*=H,a>H&&(a=H),va&&va.width(a)),s(c)&&s(d)&&(qa&&qa.html(tb(c)+Sa),ra&&ra.html(ub(d))))};this.flashAudioEnd=function(){mc()};this.flashCircleToggle=function(a){qb()};this.flashCircleOverLoader=function(a){ja.css("display","block");md(a)};this.flashCircleOutLoader=function(){ja.css("display","none")};this.flashCircleSeek= function(a){kd(a)};this.embedFlash=function(){if(R)h.useOnlyMp3Format&&!Ta&&(a=p.substr(1),embedFlashAudio(a));else{var a=B.substr(1);embedFlashMain(a);a=p.substr(1);embedFlashAudio(a);U&&(a=T.substr(1),embedFlashCircle(a))}};qf&&Aa.keyup(function(a){if(!m||v)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=a.keyCode;37==a?J.previousAudio():39==a?J.nextAudio():32==a?J.toggleAudio():77==a&&(qc(),Za());return!1});Md.resize(function(){if(!m||v)return!1; ad&&clearTimeout(ad);ad=setTimeout(Od,150)});this.setPlayIcon=function(){na&&na.hasClass("play_link")&&na.attr("src",lc);C=!1};this.playAudio=function(){if(!m||v||!u||C||!P)return!1;if("youtube_single"==z||"youtube_playlist"==z){if(!Ba)return!1;R?w.togglePlayback():"undefined"!==typeof k(B)&&k(B).pb_togglePlayback()}else N?l&&l.play():"undefined"!==typeof k(p)&&k(p).pb_play();Na("off");P=C=!0};this.pauseAudio=function(){if(!m||v||!u||!C||!P)return!1;if("youtube_single"==z||"youtube_playlist"==z){if(!Ba)return!1; R?w.togglePlayback():"undefined"!==typeof k(B)&&k(B).pb_togglePlayback()}else N?l&&l.pause():"undefined"!==typeof k(p)&&k(p).pb_pause();ta("off");C=!1};this.toggleAudio=function(){if(!m||v||!u||!P)return!1;qb()};this.stopAudio=function(){if(!m||v||!u||!P)return!1;if("youtube_single"==z||"youtube_playlist"==z){if(!Ba)return!1;R?w.stop():"undefined"!==typeof k(B)&&k(B).pb_dispose()}else N?l&&(l.src="",Ta?l.src=aa:Pb&&(l.src=gb)):"undefined"!==typeof k(p)&&k(p).pb_dispose();Ec();C=!1};this.checkAudio= function(a){if(!m||v||!u)return!1;a=a.toLowerCase();if(C){if("pause"==a)if("youtube_single"==z||"youtube_playlist"==z){if(!Ba)return!1;R?w.togglePlayback():"undefined"!==typeof k(B)&&k(B).pb_togglePlayback()}else N?l&&l.pause():"undefined"!==typeof k(p)&&k(p).pb_pause();else if("stop"==a){if("youtube_single"==z||"youtube_playlist"==z){if(!Ba)return!1;w.stop()}else N?l&&(l.src="",Ta?l.src=aa:Pb&&(l.src=gb)):"undefined"!==typeof k(p)&&k(p).pb_dispose();Ec()}C=!1;ta("off")}};this.nextAudio=function(){if(!m|| v||!u)return!1;za();q.advanceHandler(1,!0)};this.previousAudio=function(){if(!m||v||!u)return!1;za();q.advanceHandler(-1,!0)};this.loadAudio=function(a){if(!m||v||!u)return!1;if("string"===typeof a){var b=0,c=!1;for(b;b<D;b++)if(a==y[b].title){a=b;c=!0;break}if(!c)return r&&alert('Track with name "'+a+'" doesnt exist. Load audio failed.'),!1}else if("number"===typeof a){if(0>a||a>D-1)return r&&alert('Invalid track number. Track number "'+a+'" doesnt exist. Load audio failed.'),!1}else return r&& alert("Load audio method requires either a track number or a track title to load. Load audio failed."),!1;za();q.processPlaylistRequest(a)};this.loadPlaylist=function(a){if(!m||v)return!1;if("undefined"===typeof a)return r&&alert("loadPlaylist method requires data parameter. loadPlaylist failed."),!1;cb=a;wd(cb)};this.addTrack=function(a,b,c,d){if(!m||v)return!1;if("undefined"===typeof a)return r&&alert("addTrack method requires type parameter. AddTrack failed."),!1;if("undefined"===typeof b)return r&& alert("addTrack method requires format parameter. AddTrack failed."),!1;if("undefined"===typeof c)return r&&alert("addTrack method requires track parameter. AddTrack failed."),!1;var f=1,e=!1;if("string"!==typeof c&&"[object Object]"!==Object.prototype.toString.call(c))if("[object Array]"===Object.prototype.toString.call(c))f=c.length,e=!0;else return r&&alert("addTrack method requires track as string, object or array parameter. AddTrack failed."),!1;ma=d;a=a.toLowerCase();"visible"==a?(u&&ea&&Db(), Fb=!0,ea=!1):(u&&!ea&&Db(),ea=bb=!0);Oa=!1;if(u)if("undefined"!==typeof ma){if(0>ma||ma>D)return r&&alert('Invalid position to insert track to. Position number "'+d+'" doesnt exist. AddTrack failed.'),!1;ma==D&&(Oa=!0)}else Oa=!0,ma=D;else{if("undefined"!==typeof ma){if(0!=ma)return r&&alert('Invalid position to insert track to. Position number "'+d+'" doesnt exist. AddTrack failed.'),!1}else ma=0;Oa=!0}yd();v=!0;Eb=!1;d=0;var h;h="playlist"+Math.floor(9999*Math.random());var k=g("<ul id = "+h+"></ul>"); b=b.toLowerCase();for(d;d<f;d++)h=e?c[d]:c,"html"==b?Kc(h).appendTo(k):(h.type&&h.mp3||h.path)&&Fd(h).appendTo(k);x=[];db.empty();k.appendTo(db).find("li[class='playlistItem']").each(function(){x.push(g(this))});ab=!1;u||(ab=!0,u="visible"==a?ya:Ic);F()};this.inputAudio=function(a){if(!m||v)return!1;if("undefined"===typeof a)return r&&alert("inputAudio method requires data parameter. inputAudio failed."),!1;if("undefined"===a.mp3)return r&&alert("inputAudio method requires data.mp3 parameter. inputAudio failed."), !1;za();q.reSetCounter();aa=a.mp3;"undefined"!==a.ogg&&(gb=a.ogg);"undefined"!==a.title?Ga(a.title):Ga(Qb);isMobile&&(X=!0,N||"undefined"!==typeof k(p)&&k(p).pb_setAutoplay(!0));Cb();Sc()};this.removeTrack=function(a){if(!m||v||!u)return!1;if("undefined"===typeof a)return r&&alert("removeTrack method requires track parameter. removeTrack failed."),!1;if("string"===typeof a){var b=0,c=!1;for(b;b<D;b++)if(a==y[b].title){a=b;c=!0;break}if(!c)return r&&alert('Track with name "'+a+'" doesnt exist. RemoveTrack failed.'), !1;O[a]&&y[a]?(O[a].remove(),y.splice(a,1),lb(a)):r&&alert('RemoveTrack with name "'+a+'" failed.')}else if("number"===typeof a){if(0>a||a>D-1)return r&&alert('Invalid track number. Track number "'+a+'" doesnt exist. RemoveTrack failed.'),!1;O[a]&&y[a]?(O[a].remove(),y.splice(a,1),lb(a)):r&&alert('RemoveTrack with name "'+a+'" failed.')}else if("[object Array]"===Object.prototype.toString.call(a))if("string"===typeof a[0]?b=!0:"number"===typeof a[0]&&(b=!1),b){var b=0,c=a.length,d,f,e;b;a:for(;b< c;b++)if(f=a[b],"string"===typeof f){e=0;d=y.length;if(0==d){lb();break a}for(e;e<d;e++)if(f==y[e].title&&O[e]&&y[e]){O[e].remove();y.splice(e,1);lb(e);break}}}else a:for(a.sort(kf),b=0,c=a.length,b;b<c;b++){if(f=a[b],"number"===typeof f){d=y.length;if(0==d){lb();break a}-1<f&&f<d&&O[f]&&y[f]&&(O[f].remove(),y.splice(f,1),lb(f))}}else return r&&alert("removeTrack method requires track parameter as string, number or array. removeTrack failed."),!1};this.destroyAudio=function(){if(!m||v||!u)return!1; td()};this.destroyPlaylist=function(){if(!m||v||!u)return!1;Db()};this.setTitle=function(a){if(!m||v||!u)return!1;Ga(a)};this.toggleShuffle=function(){if(!m||v)return!1;la?(e.find(".player_shuffle").find("img").attr("src",bc),la=!1):(e.find(".player_shuffle").find("img").attr("src",Bb),la=!0);q.setRandom(la)};this.toggleLoop=function(){if(!m||v)return!1;ka?(e.find(".player_loop").find("img").attr("src",ac),ka=!1):(e.find(".player_loop").find("img").attr("src",Ab),ka=!0);q.setLooping(ka)};this.setVolume= function(a){if(!m||v)return!1;0>a?a=0:1<a&&(a=1);A=a;Za()};this.getVolume=function(){return m?A:!1};this.setAutoPlay=function(a){if(!m)return!1;X=a;N||"undefined"!==typeof k(p)&&k(p).pb_setAutoplay(a)};this.getAutoPlay=function(){return m?X:!1};this.getIsMobile=function(){return isMobile};this.getMobileType=function(){return hb};this.getSetupDone=function(){return m};this.getPlaylistLoaded=function(){return Eb};this.getPlaylistTransition=function(){return v};this.getMediaPlaying=function(){return!m|| v?!1:C};this.getAudioInited=function(){return!m||v?!1:P};this.getMediaType=function(){return!m||v?!1:z};this.getActiveItem=function(){return!m||v?!1:q.getCounter()};this.getPlaylistItems=function(a){if(!m||v||!O||0==O.length)return!1;if("string"===typeof a)return O;if("number"===typeof a)return 0>num||num>D-1||!O[num]?!1:O[num]};this.getMediaCount=function(){return!m||v?!1:s(D)?D:0};this.getPlaylistHidden=function(){return!m||v?!1:ea};this.get_hidden_playlist_holder=function(){return m?Ic:!1};this.getPlaylistList= function(){return m&&Ja&&0!=Ja.length?Ja:!1};this.orderPlaylist=function(a,b){if(!m||!u)return!1;if("undefined"===typeof a)return r&&alert("orderPlaylist method requires action parameter. orderPlaylist failed."),!1;var c=u.children("li"),d=c.length;if(0==d)return!1;var e=a.toLowerCase();if("reverse"==e)u.append(c.get().reverse());else if("random"==e||"remap"==e||"swap"==e){if("random"==e)b=hf(d);else if("remap"==e){if("undefined"===typeof b||b.length!=d)return!1}else if("swap"==e){if("undefined"=== typeof b||2!=b.length)return!1;c=jf(d);c.splice(b[1],1,b[0]);c.splice(b[0],1,b[1]);b=g.extend(!0,[],c)}else return!1;orderedItems=jQuery.map(b,function(a){return jQuery(O).get(a)});u.empty().html(orderedItems)}else return r&&alert("Wrong action parameter for orderPlaylist method. orderPlaylist failed."),!1;jc();if(c=ya.find("a[class=playlistSelected]").attr("data-id"))q.reSetCounter(c),Pa&&Ga()};this.checkScroll=function(){if(!m||v||!u)return!1;Bc()};this.reinitScroll=function(){if(!m||v||!u)return!1; S&&(S.reinitialise(),"vertical"==wb?(S.scrollToY(0),g(".jspPane").css("top","0px")):(S.scrollToX(0),g(".jspPane").css("left","0px")));kb&&ga&&q&&-1!=q.getCounter()&&Pa&&Ga()};this.getPlaylistData=function(){return m&&!v&&u?y:!1};this.getSoundId=function(){return m?K:!1};this.getTouch=function(){return m?sa:!1};this.get_hap_source_path=function(){return m?hap_source_path:!1};R?(g(".flashMain").remove(),g(".circleMain").remove(),N?(g(".flashAudio").remove(),ib()):Ye()):Ve();return this}}})(jQuery);